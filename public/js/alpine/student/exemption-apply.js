function removeQualification(e,t){let a=e.qualifications.indexOf(t);a>=0&&e.qualifications.splice(a,1),0==e.qualifications.length&&e.qualifications.push({...e.emptyRow})}function selectQualification(e,t,a){a.selectedItem=a.qualifications[t-1],a.selectedItem&&getExemptedInfo(a.selectedItem.id,e)}function getExemptedInfo(e,t){let a=window.urlBag.exemptionInfo+e;t.loading=!0,axios.get(a).then(e=>{t.loading=!1,t.exemptionTable=e.data}).catch(e=>{t.loading=!1,pnotify("Error",t.validator.formatServerMessage(e.response),"error"),t.exemptionTable=""})}function loadDepartments(e,t,a){a.departmentList=[],a.courseList=[],a.qualifications=[],e.exemptionTable="";let i=window.urlBag.departmentList;t&&(e.loading=!0,axios.get(i+t).then(t=>{e.loading=!1,a.departmentList=t.data.data}).catch(t=>{e.loading=!1,pnotify("Error",e.validator.formatServerMessage(t.response),"error")}))}function loadCourses(e,t,a){a.courseList=[],a.qualifications=[],e.exemptionTable="";let i=window.urlBag.courseList;t&&(e.loading=!0,axios.get(i+t).then(t=>{e.loading=!1,a.courseList=t.data.data}).catch(t=>{e.loading=!1,pnotify("Error",e.validator.formatServerMessage(t.response),"error")}))}function loadQualification(e,t,a){a.qualifications=[],e.exemptionTable="";let i=window.urlBag.qualification;t&&(e.loading=!0,axios.post(i,{uni_course_id:t}).then(t=>{e.loading=!1,a.qualifications=t.data.data}).catch(t=>{e.loading=!1,pnotify("Error",e.validator.formatServerMessage(t.response),"error")}))}function init(){return{loading:!1,validator:null,qualifications:[{...this.emptyRow}],selectedItem:null,emptyRow:{university_id:null,qualification_id:null,courseList:[],departmentList:[],qualifications:[]},popupContent:"",total:0,exemptionTable:""}}function calculateTotal(e){e.total=e.selectedItem.subjects.reduce((e,t)=>(t.selected&&(e+=t.price),e),0)}function proceed(e){if(!e.validator.validate())return;let t=window.urlBag.proceed,a=e.qualifications.map(e=>e.qualification_id),i=new Set(a);if(a.length>i.size)return pnotify("Error","Duplicate qualifications","error");let o=new FormData;for(let n=0,l=e.qualifications.length;n<l;n++){let r=e.qualifications[n];if(o.append(`q[${n}][university_id]`,r.university_id),o.append(`q[${n}][qualification_id]`,r.qualification_id),o.append(`q[${n}][uni_department_id]`,r.uni_department_id),o.append(`q[${n}][uni_course_id]`,r.uni_course_id),o.append(`q[${n}][proofFile]`,r.proofFile),o.append(`q[${n}][admissionYear]`,r.admissionYear),o.append(`q[${n}][status]`,r.status),!r.proofFile)return pnotify("Error","Please attach proof file for "+(n+1),"error")}e.loading=!0,axios.post(t,o,{headers:{"Content-Type":"multipart/form-data"}}).then(t=>{pnotify("Success",t.data.message,"success"),e.loading=!1,setTimeout(()=>{window.location=t.data.url},2e3)}).catch(t=>{e.loading=!1,pnotify("Error",e.validator.formatServerMessage(t.response),"error")})}function qualificationChanged(e,t){e.selectedItem=null,e.data.selectedSubjects=null,e.proofFile=null,e.total=0,t>0&&(e.selectedItem=e.qualifications[t-1],calculateTotal(e))}
